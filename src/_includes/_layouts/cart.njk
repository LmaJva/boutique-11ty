---
layout: _layouts/default.njk
eleventyComputed:
    title: '{{ i18n.cart_title[page.lang] | safe }}'
---

<h1 id="cart-title">{{ title }}</h1>

<section id="cart" class="" aria-labelledby="cart-title">
    <div id="cart-content" class="products-list"></div>
    <div id="cart-ticket" aria-live="polite">
        <h2 class="cart-ticket-title">{{ i18n.receipt[page.lang] }}</h2>
        <label for="destination" id="destination-label">{{ i18n.destination[page.lang] }}</label>
        <div class="select">
            <select id="destination" name="destination" aria-labelledby="destination-label" aria-required="true" role="combobox">
            {% for zone, data in shipping.grille_tarifs %}
                {% for country in data.pays[page.lang] %}
                <option value="{{ zone }}">
                    {{ country }}
                </option>
                {% endfor %}
            {% endfor %}
            </select>
        </div>

        <div class="cart-summary" aria-labelledby="subtotal-label" aria-describedby="subtotal-amount">
            <strong id="subtotal-label">{{ i18n.subtotal_amount[page.lang] }}</strong>
            <data id="subtotal-amount" class="price subtotal-amount" value="${productData.price}" itemprop="price">0.00</data>
            <meta itemprop="priceCurrency" content="EUR" />
        </div>
        <div class="cart-summary" aria-labelledby="shipping-label" aria-describedby="shipping-amount">
            <strong id="shipping-label">{{ i18n.shipping_amount[page.lang] }}</strong>
            <data id="shipping-amount" class="price shipping-amount" value="${productData.price}" itemprop="price">0.00</data>
            <meta itemprop="priceCurrency" content="EUR" />
        </div>
        <div class="cart-summary summary-total" aria-labelledby="total-label" aria-describedby="total-amount">
            <strong id="total-label">{{ i18n.total[page.lang] }}</strong>
            <data id="total-amount" class="price total-amount" value="${productData.price}" itemprop="price">0.00</data>
            <meta itemprop="priceCurrency" content="EUR" />
        </div>
        <a
          href="#"
          id="checkout-button"
          class="btn btn-card"
          data-added-text="{{ i18n.checkout_title[page.lang] }}"
          aria-label="{{ i18n.checkout_title[page.lang] }}"
        >
          {{ i18n.checkout_title[page.lang] }}
      </a>      
    </div>

  <!-- Message d'avertissement caché par défaut -->
  <div id="stripe-warning" style="display: none; background-color: #fff3cd; color: #856404; padding: 20px; margin: 20px 0; border: 1px solid #ffeeba; border-radius: 4px;">
    <p>Nous rencontrons des difficultés techniques pour finaliser votre paiement. Veuillez réessayer ou nous contacter si le problème persiste.</p>
  </div>
</section>

<section id="no-cart" class="display-none" role="alert">
    <p>{{ i18n.no_item[page.lang] }}</p>
    <a href="{{ '/' | customLocaleUrl(page.lang) | url }}" aria-label="{{ i18n.no_item_link[page.lang] }} - retour à l'accueil">
        ‹ {{ i18n.no_item_link[page.lang] }}
    </a>
</section>

<style>
  #checkout-button {
    background: var(--focus-color);
    display: flex;
    color: var(--hover-color);
    font-weight: 600;
    border: var(--border-thin);
    box-shadow: var(--shadow);
  }
</style>

<script src="https://js.stripe.com/v3/"></script>

<script>
    const shippingData = {{ shipping | dump | safe }}
</script>
